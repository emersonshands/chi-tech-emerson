--############################################### Setup mesh
chiMeshHandlerCreate()

umesh = chiUnpartitionedMeshFromWavefrontOBJ("mesh/STARCCMTemplate2.obj")

chiSurfaceMesherCreate(SURFACEMESHER_PREDEFINED)
chiVolumeMesherCreate(VOLUMEMESHER_UNPARTITIONED,umesh)

chiSurfaceMesherExecute()
chiVolumeMesherExecute()

chiVolumeMesherSetMatIDToAll(0)

matids = {
{1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2},
{1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	2,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	2},
{1,	1,	1,	1,	1,	5,	1,	1,	5,	1,	1,	5,	1,	1,	1,	1,	1,	2,	3,	3,	3,	3,	5,	3,	3,	5,	3,	3,	5,	3,	3,	3,	3,	2},
{1,	1,	1,	5,	1,	1,	1,	1,	1,	1,	1,	1,	1,	5,	1,	1,	1,	2,	3,	3,	5,	3,	4,	4,	4,	4,	4,	4,	4,	3,	5,	3,	3,	2},
{1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	2,	3,	3,	3,	4,	4,	4,	4,	4,	4,	4,	4,	4,	3,	3,	3,	2},
{1,	1,	5,	1,	1,	5,	1,	1,	5,	1,	1,	5,	1,	1,	5,	1,	1,	2,	3,	5,	4,	4,	5,	4,	4,	5,	4,	4,	5,	4,	4,	5,	3,	2},
{1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	2,	3,	3,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	3,	3,	2},
{1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	2,	3,	3,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	3,	3,	2},
{1,	1,	5,	1,	1,	5,	1,	1,	6,	1,	1,	5,	1,	1,	5,	1,	1,	2,	3,	5,	4,	4,	5,	4,	4,	6,	4,	4,	5,	4,	4,	5,	3,	2},
{1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	2,	3,	3,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	3,	3,	2},
{1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	2,	3,	3,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	3,	3,	2},
{1,	1,	5,	1,	1,	5,	1,	1,	5,	1,	1,	5,	1,	1,	5,	1,	1,	2,	3,	5,	4,	4,	5,	4,	4,	5,	4,	4,	5,	4,	4,	5,	3,	2},
{1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	2,	3,	3,	3,	4,	4,	4,	4,	4,	4,	4,	4,	4,	3,	3,	3,	2},
{1,	1,	1,	5,	1,	1,	1,	1,	1,	1,	1,	1,	1,	5,	1,	1,	1,	2,	3,	3,	5,	3,	4,	4,	4,	4,	4,	4,	4,	3,	5,	3,	3,	2},
{1,	1,	1,	1,	1,	5,	1,	1,	5,	1,	1,	5,	1,	1,	1,	1,	1,	2,	3,	3,	3,	3,	5,	3,	3,	5,	3,	3,	5,	3,	3,	3,	3,	2},
{1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	2,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	2},
{1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2},
{2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1},
{2,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	2,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1},
{2,	3,	3,	3,	3,	5,	3,	3,	5,	3,	3,	5,	3,	3,	3,	3,	2,	1,	1,	1,	1,	1,	5,	1,	1,	5,	1,	1,	5,	1,	1,	1,	1,	1},
{2,	3,	3,	5,	3,	4,	4,	4,	4,	4,	4,	4,	3,	5,	3,	3,	2,	1,	1,	1,	5,	1,	1,	1,	1,	1,	1,	1,	1,	1,	5,	1,	1,	1},
{2,	3,	3,	3,	4,	4,	4,	4,	4,	4,	4,	4,	4,	3,	3,	3,	2,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1},
{2,	3,	5,	4,	4,	5,	4,	4,	5,	4,	4,	5,	4,	4,	5,	3,	2,	1,	1,	5,	1,	1,	5,	1,	1,	5,	1,	1,	5,	1,	1,	5,	1,	1},
{2,	3,	3,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	3,	3,	2,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1},
{2,	3,	3,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	3,	3,	2,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1},
{2,	3,	5,	4,	4,	5,	4,	4,	6,	4,	4,	5,	4,	4,	5,	3,	2,	1,	1,	5,	1,	1,	5,	1,	1,	6,	1,	1,	5,	1,	1,	5,	1,	1},
{2,	3,	3,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	3,	3,	2,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1},
{2,	3,	3,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	3,	3,	2,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1},
{2,	3,	5,	4,	4,	5,	4,	4,	5,	4,	4,	5,	4,	4,	5,	3,	2,	1,	1,	5,	1,	1,	5,	1,	1,	5,	1,	1,	5,	1,	1,	5,	1,	1},
{2,	3,	3,	3,	4,	4,	4,	4,	4,	4,	4,	4,	4,	3,	3,	3,	2,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1},
{2,	3,	3,	5,	3,	4,	4,	4,	4,	4,	4,	4,	3,	5,	3,	3,	2,	1,	1,	1,	5,	1,	1,	1,	1,	1,	1,	1,	1,	1,	5,	1,	1,	1},
{2,	3,	3,	3,	3,	5,	3,	3,	5,	3,	3,	5,	3,	3,	3,	3,	2,	1,	1,	1,	1,	1,	5,	1,	1,	5,	1,	1,	5,	1,	1,	1,	1,	1},
{2,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	2,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1},
{2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1}}

lvs = {}
ds = 1.26
for i=1,34 do
    lvs[i]={}
    for j=1,34 do
        x0 =  ds/2 + (i-1)*ds
        y0 = -ds/2 - (j-1)*ds
        lvs[i][j] = chiLogicalVolumeCreate(RCC,x0,y0,-1, 0,0,2, 0.54702084)
        chiVolumeMesherSetProperty(MATID_FROMLOGICAL, lvs[i][j],matids[i][j])
        -- print(x0,y0,matids[i][j])
    end
end




----############################################### Setup mesh
-- chiMeshHandlerCreate()
--
-- umesh = chiUnpartitionedMeshFromMshFormat("mesh/2D_c5g7_coarse.msh",true)
--
-- --############################################### Create meshers
-- chiSurfaceMesherCreate(SURFACEMESHER_PREDEFINED);
-- chiVolumeMesherCreate(VOLUMEMESHER_UNPARTITIONED,umesh);
--
-- --chiVolumeMesherSetKBAPartitioningPxPyPz(2,2,1)
-- --chiVolumeMesherSetKBACutsX({27.72})
-- --chiVolumeMesherSetKBACutsY({27.72})
-- --chiVolumeMesherSetProperty(PARTITION_TYPE,KBA_STYLE_XYZ)
--
--
-- --############################################### Execute meshing
-- chiSurfaceMesherExecute();
-- chiVolumeMesherExecute();
